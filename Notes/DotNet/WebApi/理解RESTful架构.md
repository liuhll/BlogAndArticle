# 理解RESTful架构
@(.Net学习)[Restful]


- [理解RESTFU架构](http://www.ruanyifeng.com/blog/2011/09/restful)
- [我所理解的RESTful Web API [设计篇]](http://www.cnblogs.com/artech/p/3506553.html)
- [我所理解的RESTful Web API [Web标准篇]](http://www.cnblogs.com/artech/p/restful-web-api-01.html)

## Restful架构风格
- 目前业界更为推崇的构建新一代`Web服务`（或者`Web API`）的架构风格
- 仅仅是一种架构风格，所以它是**与具体的技术平台无关的**
- `REST`是面向`资源`的

## 网站即软件
- 一种新型的软件
- 互联网软件 **分布式体系**，通过互联网通信
- 具有 `高延时`  `高并发`
- 采用软件开发的模式开发网站

## RESTFUL 架构
- `RESTful架构`，就是目前最流行的一种`互联网软件架构`
- **结构清晰**、**符合标准**、**易于理解**、**扩展方便**

### 起源
### 名称
- `Representational State Transfer`===`表现层状态转化`

### 资源（Resources）
- 所谓`资源`，就是网络上的一个实体，或者说是网络上的一个具体信息。总之就是一个具体的实在
   - 一段文本、一张图片、一首歌曲、一种服务
   - 可以用一个`URI`（统一资源定位符）指向它，每种资源对应一个特定的URI
   - "上网"，就是与互联网上一系列的"资源"互动，调用它的URI

#### Web资源
- **定义：** 任何寄宿于`Web服务器`可以利用`HTTP协议`获取或者操作的**事物**均可以称为`资源`
  - 不仅仅是寄宿于Web服务器的某个静态物理文件可以视为`Web资源`
  - 通过Web应用根据请求动态生成的数据也是`Web资源`
- 资源实际上是一种承载着某种信息的**数据**

#### 媒体类型 ---- `Media Type`
- **媒体类型**又被称为`MIME`（**Multipurpose Internet Mail Extension**）类型，`MIME`是一个互联网标准，它扩展了电子邮件标准，使其能够支持非ASCII字符、二进制格式附件等多种格式的邮件消息
    1. `text/html`：HTML格式的文档。
    2. `text/xml`（`application/xml`）：XML格式的文本。
    3. `text/json`（`application/json`）： JSON格式的文本。
    4. `image/gif`（`image/jpeg`、`image/png`）：GIF（JPEG、PNG）格式的图片。
    5. `audio/mp4`（`audio/mpeg`、`audio/vnd.wave`）：MP4（MPEG、WAVE）格式的音频文件。
    6. `video/mp4`（`video/mpeg`、`video/quicktime`）：MP4（MPEG、QUICKTIME）格式的视频文件。 

## URI、URL和URN
- `Web资源`应该具有一个 **唯一的标识**
- 采用`URI`来标识**Web资源**已经成为了一种共识
- 统一资源标志符（`Uniform Resource Identifier`）

- 统一资源定位符（`Uniform Resource Locator`）
   - 标识性之外，它还具有定位的功能，用于描述Web资源所在的位置

- URI和URL之间的区别
   - 一个`URL`肯定是一个`URI`，但是一个`URI`并不一定是一个`URL`

### HTTP事务
- 一次`HTTP事务`（`Transaction`）**始于请求的发送，止于响应的接收**
- 每个`HTTP事务`均是相互**独立**的

### HTTP方法
- 至于针对资源的操作类型，不外乎`CRUD`（`Create`、`Retrieve`、`Update`和`Delete`）
- `HTTP Method`或者`HTTP Verb`
  - 常用的HTTP方法 包括`GET`、`POST`、`PUT`、`DELETE`、`HEAD`、`OPTIONS`、`TRACE`、`CONNECTION`和`PATCH`

### 响应状态码
- 不论在何种情况下得到一个响应，每个响应均具有一个由**3位数字**表示的`状态码`和相应的描述文字。不同数值的状态码体现了不同类型的响应状态
    1. 100~199：**信息状态码**，代表请求已被接受，需要继续处理。
    2. 200~299：**成功状态码**，代表请求已成功被服务器接收、理解、并接受。
    3. 300~399：**重定向状态码**，代表需要客户端采取进一步的操作才能完成请求。
    4. 400~499：**客户端错误状态码**，代表了客户端看起来可能发生了错误，妨碍了服务器的处理。
    5. 500~599：**服务器错误状态码**，代表了服务器在处理请求的过程中有错误或者异常状态发生，也有可能是服务器意识到以当前的软硬件资源无法完成对请求的处理。

### HTTP报文
- 客户端和Web服务器在一次`HTTP事务`中**交换的消息**被称为`HTTP报头`
#### 构成
- 起始行
  - 请求报文利用**起始行**表示采用的`HTTP方法`、`请求URI`和`采用的HTTP版本`
  - 响应报文的起始行在承载着`HTTP版本`和`响应状态码`等信息
- 报头集合
  - 每个报头表现为一个`键/值对`，`键`和`值`分别表示`报头名称`和`报头的值`，两者通过冒号（“：”）进行分割

- 主体内容
  - 客户端提交给服务器的数据一般置于**请求报头的主体**
  - **响应报头的主体**也承载着服务器返回给客户端的数据
  - 其主体部分均是可以**缺省的**

#### 请求报文
- 客户端发送给服务器的`请求消息`

#### 响应报头
- 服务器返回给客户端的`响应消息`


### 表现层（Representation）
- `表现层`其实指的是`资源`（`Resources`）的**表现层**
- `资源`是一种信息实体，它可以有`多种外在表现形式`。我们把"资源"具体呈现出来的形式，叫做它的`表现层`（Representation）。
   - 文本可以用txt格式表现，也可以用`HTML格式`、`XML格式`、`JSON格式表现`，甚至可以采用二进制格式；图片可以用JPG格式表现，也可以用PNG格式表现
   - 它的**具体表现形式**，应该在**HTTP请求的头信息中用Accept和Content-Type字段指定**，这两个字段才是对"表现层"的描述

### 状态转化（State Transfer）
- 访问一个网站，就代表了客户端和服务器的一个**互动过程**。
在这个过程中，**势必涉及到`数据`和`状态`的变化**
- 通信协议`HTTP协议`，是一个`无状态协议`
- 如果客户端想要操作服务器，必须通过某种手段，让服务器端发生`状态转化"（State Transfer）`
- 客户端用到的手段，只能是`HTTP协议`
- 四个表示操作方式的动词：`GET`、`POST`、`PUT`、`DELETE`
	- `GET`用来**获取**资源，
	- `POST`用来**新建**资源（也可以用于更新资源），
	- `PUT`用来**更新**资源，
	- `DELETE`用来**删除**资源


## 综述
1. 每一个`URI`代表一种资源；
2. 客户端和服务器之间，**传递这种资源的某种`表现层**；
3. 客户端通过四个`HTTP动词`，对服务器端资源进行操作，实现`表现层状态转化`

## 误区
- 最常见的一种设计错误，**就是`URI`包含动词**
> 因为`资源`表示一种实体，所以应该是名词，`URI`不应该有动词，动词应该放在HTTP协议中
> 资源**不能**是动词，但是可以是一种服务