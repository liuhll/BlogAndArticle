# 使用 Async 和 Await 的异步编程
- [异步编程](https://msdn.microsoft.com/zh-cn/library/hh191443.aspx)
## 异步提高响应能力
异步对可能引起阻塞的活动（例如应用程序访问 Web 时）至关重要，在异步过程中，应用程序**可继续执行不依赖 Web 资源的其他工作**，直至潜在阻止任务完成  
由于所有与用户界面相关的活动通常共享一个线程，因此，`异步`对访问 `UI线程`的应用程序来说尤为重要

- 使用`异步方法`时，应用程序将继续响应`UI`

## 异步方法
- 方法签名包含一个 `Async` 或 `async` 修饰符。
- 按照约定，**异步方法的名称**以`Async`后缀为结尾。
- 返回类型为下列类型之一：
   1. 如果你的方法有操作数为 `TResult` 类型的返回语句，则为 `Task<TResult>`。
   2. 如果你的方法**没有返回语句**或具有**没有操作数**的返回语句，则为 `Task`。
   3. 如果你编写的是异步事件处理程序，则为 Void（Visual Basic 中为 Sub）。
   4. 异步方法的返回类型可以为 `Task`、`Task<TResult>` 或`void`。  方法不能声明任何 `ref` 或 `out` 参数，但是可以调用具有这类参数的方法
- 方法通常包含**至少一个`await`表达式**,该表达式**标记一个点**，在该点上，直到等待的异步操作完成方法才能继续。 同时，将方法挂起，并且控件返回到方法的调用方。

## 异步和等待
- 标记的异步方法可以使用`Await` 或 `await` 来指定**悬挂点**。 `await` 运算符通知编译器异步方法只有直到等待的异步过程完成才能继续通过该点。
 同时，控件返回至异步方法的调用方。
`await 表达式`中异步方法的挂起不能使该方法退出，并且 `finally` 块不会运行。
- 标记的异步方法本身可以通过调用它的方法等待。

> 异步方法通常包含 `await` 运算符的一个或多个匹配项，但缺少 `await表达式`不会导致编译器错误。 如果异步方法未使用 `await` 运算符标记悬挂点，则该方法将作为同步方法执行，不管异步修饰符如何。

## async
- 使用`async`修饰符可将`方法`、`lambda表达式`或`匿名方法`指定为**异步**。
- 如果对方法或表达式使用此修饰符，则其称为**异步方法**
- `async关键字`是**上下文关键字**，原因在于只有当它修饰方法、`lambda表达式`或匿名方法时，它才是关键字。
  -  在所有其他上下文中，都会将其解释为标识符。  

## await
- `await` 运算符在异步方法应用于任务，以挂起执行方法，直到所等待的任务完成。 
- 这个任务表示**正在进行的工作**

- `await表达式`**不阻止**正在执行它的线程。而是使编译器将剩下的异步方法注册为等待任务的延续任务。控制权随后会返回给异步方法的调用方。任务完成时，它会调用其延续任务，异步方法的执行会在暂停的位置处恢复。
- `await表达式`只能在由`async`修饰符标记的**立即封闭方法体**、`lambda 表达式`或`异步方法`中出现。术语`await`在该上下文中仅用作关键字。在其他位置，它会解释为标识符。
   - `await表达式`**不能**在同步函数体、查询表达式、lock 语句块或不安全上下文中出现。